<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>PDF Merger & Editor</title>
		<!-- Updated CSP: removed unsafe-eval for better security -->
		<meta
			http-equiv="Content-Security-Policy"
			content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: file:; connect-src 'self' file: blob:;"
		/>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div class="app">
			<div id="langToggle" class="lang-toggle">🇯🇵 日本語</div>

			<header class="topbar">
				<div class="brand">
					<div class="logo">📎</div>
					<div>
						<h1 id="title">PDF結合ツール</h1>
						<p class="subtitle" id="subtitle">ローカルで高速結合・編集</p>
					</div>
				</div>
				<div class="controls">
					<input
						id="fileElem"
						type="file"
						accept=".pdf,.png,.jpg,.jpeg"
						multiple
					/>
					<label class="btn primary" for="fileElem" id="addBtn"
						>ファイル追加</label
					>
					<button class="btn" id="clearBtn">全削除</button>
					<button class="btn primary" id="mergeEditBtn">結合して編集</button>
				</div>
			</header>

			<main>
				<section id="drop-area" class="drop-area">
					<div class="drop-inner">
						<div class="drop-icon">⬇️</div>
						<div class="drop-text" id="dropText">
							ここにドラッグ＆ドロップ または「ファイル追加」
						</div>
					</div>

					<div id="filesList" class="files-grid"></div>
				</section>

				<aside class="merge-panel">
					<div class="summary">
						<div id="count">0 個のファイル</div>
						<div id="totalsize">0 KB</div>
					</div>
					<button class="btn big" id="mergeBtn">結合する(保存のみ)</button>
					<div id="status" class="status">
						すべてPC内で処理(アップロードなし)
					</div>
				</aside>
			</main>

			<footer class="footer">
				<small id="footerText">ドラッグで並び替え、×で削除できます。</small>
        <div class="developer-credit">
        <small><strong>Allagi</strong> Original by <strong>Utsav Adhikari</strong> </small>
      </div>

			</footer>
		</div>

		<!-- Editor overlay -->
		<div id="editorOverlay" class="editor-overlay hidden">
			<div class="editor-topbar">
				<div class="editor-tools">
					<button class="tool" data-tool="pointer" title="Pointer">
						<img src="icons/pointer.svg" alt="Pointer" />
					</button>
					<button class="tool" data-tool="rect" title="Rectangle">
						<img src="icons/square.svg" alt="Rectangle" />
					</button>
					<button class="tool" data-tool="arrow" title="Arrow">
						<img src="icons/arrow.svg" alt="Arrow" />
					</button>
					<button class="tool" data-tool="pen" title="Pen">
						<img src="icons/pen.svg" alt="Pen" />
					</button>
					<button class="tool" data-tool="text" title="Text">
						<img src="icons/type.svg" alt="Text" />
					</button>
					<button class="tool" data-tool="highlight" title="Highlight">
						<img src="icons/highlighter.svg" alt="Highlight" />
					</button>

					<!-- Color Picker Panel -->
					<div class="color-picker-panel">
						<div class="color-label">Color:</div>
						<div class="color-options">
							<button class="color-btn active" data-color="#ff0000" style="background: #ff0000;" title="Red"></button>
							<button class="color-btn" data-color="#0b5fff" style="background: #0b5fff;" title="Blue"></button>
							<button class="color-btn" data-color="#10b981" style="background: #10b981;" title="Green"></button>
							<button class="color-btn" data-color="#fbbf24" style="background: #fbbf24;" title="Yellow"></button>
							<button class="color-btn" data-color="#f97316" style="background: #f97316;" title="Orange"></button>
							<button class="color-btn" data-color="#a855f7" style="background: #a855f7;" title="Purple"></button>
							<button class="color-btn" data-color="#ec4899" style="background: #ec4899;" title="Pink"></button>
							<button class="color-btn" data-color="#000000" style="background: #000000;" title="Black"></button>
						</div>
					</div>

					<button class="tool" id="undoBtn" title="Undo">
						<img src="icons/undo.svg" alt="Undo" />
					</button>
					<button class="tool" id="redoBtn" title="Redo">
						<img src="icons/redo.svg" alt="Redo" />
					</button>
					<button class="tool save-pdf-btn" id="doneBtn" title="Save PDF">
						<img src="icons/save.svg" alt="Save" />
						<span>Save PDF</span>
					</button>
					<button class="tool close-btn" id="closeEditor" title="Close">
						<img src="icons/x.svg" alt="Close" />
					</button>
				</div>
				<div class="editor-page-nav">
					<button id="prevPage">◀</button>
					<span id="pageLabel">1 / 1</span>
					<button id="nextPage">▶</button>
				</div>
			</div>
			<div class="editor-body">
				<div id="pageContainer" class="page-container"></div>
			</div>
		</div>

		<script type="module" src="./renderer.js"></script>
	</body>
</html>
