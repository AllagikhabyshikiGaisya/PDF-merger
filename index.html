<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>PDF Merger & Editor</title>
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: file:; connect-src 'self' file: blob: https://cdn.jsdelivr.net;"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Language Toggle -->
    <div
      id="langToggle"
      class="lang-toggle"
      role="button"
      tabindex="0"
      aria-label="Switch language"
    >
      üáØüáµ Êó•Êú¨Ë™û
    </div>

    <!-- Main App Container (Merger Page) -->
    <div id="mainApp" class="app">
      <header class="topbar">
        <div class="brand">
          <div class="logo" aria-hidden="true">
            <img src="./icons/pdf-icon.svg" alt="PDF" />
          </div>
          <div class="title">
            ALLAGI
            <span class="heart-icon-container"
              ><img src="./icons/heart-icon.svg" alt="Love`s"
            /></span>
            PDF
          </div>
        </div>
      </header>

      <main class="main-container">
        <section
          id="drop-area"
          class="drop-area"
          role="region"
          aria-label="File upload area"
        >
          <div class="drop-inner">
            <div class="drop-icon" aria-hidden="true">
              <img
                class="arrow-down-icon"
                src="./icons/arrow-down-icon.svg"
                alt="arrow-down-icon"
              />
            </div>
            <div class="drop-text" id="dropText">
              „Åì„Åì„Å´„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó „Åæ„Åü„ÅØ„Äå„Éï„Ç°„Ç§„É´ËøΩÂä†„Äç
            </div>
          </div>

          <div id="filesList" class="files-grid" role="list"></div>
        </section>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none">
          <div class="loading-spinner">
            <div class="taichi-spinner"></div>
            <div class="loading-text">
              <span id="loadingProgress">Loading files...</span>
              <span id="loadingCount" class="loading-count">0 / 0</span>
            </div>
          </div>
        </div>
        <!-- ‚úÖ Merge Progress Overlay -->
        <div
          class="merge-progress-overlay"
          id="mergeProgressOverlay"
          style="display: none"
        >
          <div class="merge-progress-container">
            <div class="merge-progress-icon">
              <svg
                width="60"
                height="60"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
              </svg>
            </div>
            <div class="merge-progress-text" id="mergeProgressText">
              Merging files...
            </div>
            <div class="merge-progress-bar">
              <div class="merge-progress-fill" id="mergeProgressFill"></div>
            </div>
            <div class="merge-progress-percent" id="mergeProgressPercent">
              0%
            </div>
            <div class="merge-progress-detail" id="mergeProgressDetail">
              Processing files...
            </div>
          </div>
        </div>
        <aside class="merge-panel">
          <div class="controls">
            <input
              id="fileElem"
              type="file"
              accept=".pdf,.png,.jpg,.jpeg"
              multiple
              aria-label="Select PDF or image files"
            />
            <div class="upload-button-container" id="upload-button">
              <img src="./icons/upload-icon.svg" alt="+" />
              <label
                class="merge-panel-btn label-text"
                for="fileElem"
                id="addBtn"
                >„Éï„Ç°„Ç§„É´ËøΩÂä†</label
              >
            </div>
            <div class="clear-wrapper">
              <img
                class="clear-icon"
                src="./icons/clear-icon.svg"
                alt="clear"
              />
              <button class="merge-panel-btn btn clear-btn" id="clearBtn">
                ÂÖ®ÂâäÈô§
              </button>
            </div>
            <!-- NEW: PDF Split Button -->
            <div class="split-wrapper">
              <img
                class="split-icon"
                src="./icons/split-icon.svg"
                alt="split"
              />
              <button class="merge-panel-btn btn split-btn" id="pdfSplitBtn">
                <span id="splitBtnText">PDFÂàÜÂâ≤</span>
              </button>
            </div>
            <!-- PDF Organizer Button -->
            <div class="organizer-wrapper">
              <img
                class="organizer-icon"
                src="./icons/organizer-icon.svg"
                alt="organize"
              />
              <button
                class="merge-panel-btn btn organizer-btn"
                id="pdfOrganizerBtn"
              >
                <span id="organizerBtnText">„Éö„Éº„Ç∏Êï¥ÁêÜ</span>
              </button>
            </div>
          </div>
          <div class="summary">
            <div id="count">0 ÂÄã„ÅÆ„Éï„Ç°„Ç§„É´</div>
            <div id="totalsize">0 KB</div>
          </div>
          <div class="merge-wrapper">
            <img class="merge-icon" src="./icons/merge-icon.svg" alt="merge" />
            <button class="merge-panel-btn big" id="mergeBtn">
              <span id="merge-wrapper-text">ÁµêÂêà„Åô„Çã</span>
            </button>
          </div>
          <div class="editor-wrapper">
            <img class="edit-icon" src="./icons/edit-icon.svg" alt="editor" />
            <button class="merge-panel-btn big green" id="mergeEditBtn">
              ÁµêÂêà„Åó„Å¶Á∑®ÈõÜ
            </button>
          </div>
          <div id="status" class="status" role="status" aria-live="polite">
            „Åô„Åπ„Å¶PCÂÜÖ„ÅßÂá¶ÁêÜ(„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Å™„Åó)
          </div>
        </aside>
      </main>

      <footer class="footer">
        <small id="footerText">„Éâ„É©„ÉÉ„Ç∞„Åß‰∏¶„Å≥Êõø„Åà„ÄÅ√ó„ÅßÂâäÈô§„Åß„Åç„Åæ„Åô„ÄÇ</small>
        <div class="developer-credit">
          <small
            ><strong>Allagi</strong> Original by
            <strong>Utsav Adhikari</strong></small
          >
        </div>
      </footer>
    </div>

    <!-- Editor Page (Existing) -->
    <div id="editorPage" class="editor-page" style="display: none">
      <div class="editor-content">
        <aside class="thumbnail-sidebar">
          <div id="thumbnailContainer" class="thumbnail-container"></div>
        </aside>

        <main class="canvas-area">
          <div class="canvas-container">
            <canvas id="mainCanvas"></canvas>
            <canvas id="annotCanvas"></canvas>
          </div>
        </main>

        <aside class="editor-toolbar-sidebar">
          <div class="toolbar-section">
            <div class="toolbar-section-title">Navigation</div>
            <div class="editor-actions">
              <button class="btn" id="backToMerger">ÁµêÂêà„Éö„Éº„Ç∏„Å´Êàª„Çã</button>
              <button class="btn green" id="savePdf">PDF„Çí‰øùÂ≠ò</button>
            </div>
          </div>

          <div class="toolbar-section">
            <div class="toolbar-section-title">Zoom</div>
            <div class="zoom-controls">
              <div class="zoom-display" id="zoomDisplay">100%</div>
              <div class="zoom-btn-row">
                <button class="btn zoom-btn" id="zoomOutBtn" title="Zoom Out">
                  ‚àí
                </button>
                <button
                  class="btn zoom-btn"
                  id="resetZoomBtn"
                  title="Reset Zoom"
                >
                  ‚ü≤
                </button>
                <button class="btn zoom-btn" id="zoomInBtn" title="Zoom In">
                  +
                </button>
              </div>
            </div>
          </div>

          <div class="toolbar-section">
            <div class="toolbar-section-title">Tools</div>
            <div class="annotation-tools">
              <div class="tool-row">
                <button
                  class="tool-btn active"
                  data-tool="pointer"
                  title="Pointer"
                >
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" />
                  </svg>
                </button>
                <button
                  class="tool-btn"
                  data-tool="rectangle"
                  title="Rectangle"
                >
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <rect x="3" y="3" width="18" height="18" rx="2" />
                  </svg>
                </button>
                <button
                  class="tool-btn"
                  data-tool="highlight"
                  title="Highlight"
                >
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                  >
                    <path
                      d="M17.7 4.3a1 1 0 0 1 0 1.4l-11 11a1 1 0 0 1-1.4 0l-2-2a1 1 0 0 1 1.4-1.4l1.3 1.3 10.3-10.3a1 1 0 0 1 1.4 0z"
                    />
                    <path d="M2 20h20v2H2z" opacity="0.5" />
                  </svg>
                </button>
                <button class="tool-btn" data-tool="line" title="Line">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <line x1="7" y1="17" x2="17" y2="7" />
                    <polyline points="12,7 17,7 17,12" />
                  </svg>
                </button>
                <button class="tool-btn" data-tool="pen" title="Pen">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M12 19l7-7 3 3-7 7-3-3z" />
                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
                    <path d="M2 2l7.586 7.586" />
                  </svg>
                </button>
                <button class="tool-btn" data-tool="text" title="Text">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <polyline points="4 7 4 4 20 4 20 7" />
                    <line x1="9" y1="20" x2="15" y2="20" />
                    <line x1="12" y1="4" x2="12" y2="20" />
                  </svg>
                </button>
              </div>

              <div class="tool-divider"></div>

              <div class="tool-row">
                <button class="tool-btn" id="undoBtn" title="Undo">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M3 7v6h6" />
                    <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" />
                  </svg>
                </button>
                <button class="tool-btn" id="redoBtn" title="Redo">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                  >
                    <path d="M21 7v6h-6" />
                    <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7" />
                  </svg>
                </button>
              </div>
            </div>
          </div>

          <div class="toolbar-section">
            <div class="toolbar-section-title">Colors</div>
            <div class="color-picker">
              <button
                class="color-btn active"
                data-color="#ff0000"
                style="background: #ff0000"
                title="Red"
              ></button>
              <button
                class="color-btn"
                data-color="#00ff00"
                style="background: #00ff00"
                title="Green"
              ></button>
              <button
                class="color-btn"
                data-color="#0000ff"
                style="background: #0000ff"
                title="Blue"
              ></button>
              <button
                class="color-btn"
                data-color="#ffff00"
                style="background: #ffff00"
                title="Yellow"
              ></button>
              <button
                class="color-btn"
                data-color="#ff00ff"
                style="background: #ff00ff"
                title="Magenta"
              ></button>
              <button
                class="color-btn"
                data-color="#00ffff"
                style="background: #00ffff"
                title="Cyan"
              ></button>
              <button
                class="color-btn"
                data-color="#000000"
                style="background: #000000"
                title="Black"
              ></button>
              <button
                class="color-btn"
                data-color="#ffffff"
                style="background: #ffffff; border: 1px solid #ccc"
                title="White"
              ></button>
            </div>
          </div>
        </aside>
      </div>
    </div>

    <!-- NEW: Feature Container (All new features load here) -->
    <div id="featureContainer" style="display: none"></div>

    <script type="module" src="./renderer.js"></script>
  </body>
</html>
