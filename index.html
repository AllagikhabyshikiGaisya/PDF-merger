<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>PDF Merger & Editor</title>
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: file:; connect-src 'self' file: blob: https://cdn.jsdelivr.net;"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- Language Toggle -->
    <div
      id="langToggle"
      class="lang-toggle"
      role="button"
      tabindex="0"
      aria-label="Switch language"
    >
      🇯🇵 日本語
    </div>

    <!-- Main App Container (Merger Page) -->
    <div id="mainApp" class="app">
      <header class="topbar">
        <div class="brand">
          <div class="logo" aria-hidden="true">
            <img src="./icons/pdf-icon.svg" alt="PDF" />
          </div>
          <div class="title">
            ALLAGI
            <span class="heart-icon-container"
              ><img src="./icons/heart-icon.svg" alt="Love`s"
            /></span>
            PDF
          </div>
        </div>
      </header>

      <main class="main-container">
        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none">
          <div class="loading-spinner">
            <div class="taichi-spinner"></div>
            <div class="loading-text">
              <span id="loadingProgress">Loading files...</span>
              <span id="loadingCount" class="loading-count">0 / 0</span>
            </div>
          </div>
        </div>

        <!-- Add this inside .controls section (after line ~70) -->

        <div class="feature merge-wrapper" id="mergePdfBtn">
          <img class="feature-icon" src="./icons/merge-icon.png" alt="merge" />
          <div class="feature-detail">
            <div class="feature-name" id="mergePdfBtnText">PDF結合</div>
            <div class="feature-about">
              PDF、JPEG、PNGを希望の順序で結合します。
            </div>
          </div>
        </div>

        <!-- NEW: PDF Split Button -->
        <div class="feature split-wrapper" id="pdfSplitBtn">
          <img class="feature-icon" src="./icons/split-icon.png" alt="split" />

          <div class="feature-detail">
            <div class="feature-name" id="splitBtnText">PDF分割</div>
            <div class="feature-about">
              PDF の 1
              ページまたはすべてのページを個別のファイルに簡単に変換できます。
            </div>
          </div>
        </div>
        <!-- PDF Organizer Button -->
        <div class="feature organize-wrapper" id="pdfOrganizerBtn">
          <img
            class="feature-icon"
            src="./icons/organizer-icon.png"
            alt="organize"
          />

          <div class="feature-detail">
            <div class="feature-name" id="organizerBtnText">ページ整理</div>
            <div class="feature-about">
              好きなように PDF を整理し、PDF ページを削除したり、ドキュメントに
              PDF ページを追加したりできます。
            </div>
          </div>
        </div>
        <!-- PDF to JPEG Button -->
        <div class="feature jpeg-wrapper" id="pdfToJpegBtn">
          <img
            class="feature-icon jpg-icon"
            src="./icons/jpeg-icon.png"
            alt="jpeg"
          />

          <div class="feature-detail">
            <div class="feature-name" id="pdfToJpegBtnText">PDF JPEG 変換</div>
            <div class="feature-about">各 PDF ページを JPG に変換します。</div>
          </div>
        </div>

        <div class="feature editor-wrapper" id="mergeEditBtn">
          <img class="feature-icon" src="./icons/edit-icon.png" alt="editor" />
          <div class="feature-detail">
            <div class="feature-name">結合して編集</div>
            <div class="feature-about">
              テキストやハイライトをさまざまな色で追加して、PDF
              を強調表示します。
            </div>
          </div>
        </div>
      </main>

      <footer class="footer">
        <small id="footerText">ドラッグで並び替え、×で削除できます。</small>
        <div class="developer-credit">
          <small
            ><strong>Allagi</strong> Original by
            <strong>Utsav Adhikari</strong></small
          >
        </div>
      </footer>
    </div>

    <!-- NEW: Feature Container (All new features load here) -->
    <div id="featureContainer" style="display: none"></div>

    <!-- ============= FORCED UPDATE MODAL ============= -->
    <div id="updateModal" class="update-modal" style="display: none">
      <div class="update-modal-content">
        <div class="update-icon">
          <svg
            width="64"
            height="64"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#c41e3a"
            stroke-width="2"
          >
            <path d="M21 12a9 9 0 11-6.219-8.56" />
            <path d="M13 3v6h6" />
          </svg>
        </div>

        <h2 id="updateTitle" class="update-title">アップデートを確認中...</h2>
        <p id="updateMessage" class="update-message">少々お待ちください</p>

        <!-- Progress Section -->
        <div
          id="updateProgressSection"
          class="update-progress-section"
          style="display: none"
        >
          <div class="progress-bar-container">
            <div
              id="updateProgressBar"
              class="progress-bar"
              style="width: 0%"
            ></div>
          </div>
          <div class="progress-info">
            <span id="updateProgressPercent">0%</span>
            <span id="updateProgressSize">0 MB / 0 MB</span>
            <span id="updateProgressSpeed">0 KB/s</span>
          </div>
        </div>

        <!-- Version Info -->
        <div
          id="updateVersionInfo"
          class="update-version-info"
          style="display: none"
        >
          <div class="version-row">
            <span class="version-label">現在のバージョン:</span>
            <span id="updateCurrentVersion" class="version-value">-</span>
          </div>
          <div class="version-row">
            <span class="version-label">新しいバージョン:</span>
            <span id="updateNewVersion" class="version-value highlight">-</span>
          </div>
        </div>

        <!-- Status Message -->
        <div id="updateStatus" class="update-status">
          <div class="status-spinner"></div>
          <span id="updateStatusText">処理中...</span>
        </div>

        <!-- Error Section -->
        <div
          id="updateErrorSection"
          class="update-error-section"
          style="display: none"
        >
          <div class="error-icon">⚠️</div>
          <p id="updateErrorMessage" class="error-message"></p>
          <button id="retryUpdateBtn" class="retry-btn">再試行</button>
        </div>
      </div>
    </div>

    <script type="module" src="./renderer.js"></script>
  </body>
</html>
